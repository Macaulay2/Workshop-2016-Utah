--**************************************************
--**************************************************
--This file houses functions related to test ideals.
--**************************************************
--**************************************************



--Computes the test ideal of (R, f^(a/(p^e - 1))) when R is a polynomial ring.

tauAOverPEMinus1Poly := (e,a,f) -> (
     R := ring f;
     p := char R;
     b := a % (p^e - 1);
     k := a // (pp^e - 1); 
     I := ethRootSafe(fm, ideal(f), a2, e);
     I = ascendIdealSafe(I, fm, a2, e1);
     I*ideal(f^k)
)

--------------------------------------------------------------------------------------------------------


--Computes the test ideal of (R, f^t), when R is a polynomial ring over a perfect field.

tauPoly := (t,f) -> (
     R := ring f; 
     p := char R;
     L := divideFraction(t,p); --gives {a,b,c} where t = a/(p^b*(p^c-1))
     local I;
     --first we compute tau(fm^{a/(p^c-1)})
     if (L1#2 != 0) then (
     	I1 = tauAOverPEMinus1Poly(f,L#0,L#2);
     	if (L#1 != 0) then
     		I = ethRoot(I, L#1)
     	)
     else (
     	if (L#1 != 0) then
     		I1 = ethRootSafe(f, ideal( sub(1, R)), L#0, L#1 )
     	else
 	    		I = ideal(f^(L#0))
 	    	);
     I1
)
